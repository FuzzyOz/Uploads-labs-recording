# Pass-11 (%00截断)

可以看到这里使用了白名单，同时提示告诉我们上传路径是可控的。

使用%00截断来过白名单，在bp中修改第一行post请求

```
POST /Pass-11/index.php?save_path=../upload/名字.php%00 HTTP/1.1
```

同时在下面修改filename为合法化后缀。

实际的平台靶场是无法上传的，因为%00截断需要php版本为5.2版本以下且GPC关闭，所以学到姿势就行了。

# Pass-12 (POST方式+%00截断)

观察发现

```php
$img_path = $_POST['save_path']."/".rand(10, 99).date("YmdHis").".".$file_ext;
```

被改成了post方式上传，所以需要修改二进制内容，在文件名后面手动加入一个00字符即可截断。

平台靶场无法上传。

# Pass-13 (图片马)

要求上传一个图片马，借助cmd可以合成图片马，语句如下：

```
copy 1.jpg/b + phpinfo.php/a 11.jpg
```

phpinfo中写入可执行的php代码（测试使用的是phpinfo)

上传。根据提示本题只对上传文件的前两位字节进行了检测，即头文件检测，所以很容易过。

然后在文件包含页面进行包含操作即可，此处注意的是对文件名进行了重命名，所以需要右键确定上传路径来访问。

# Pass-14 (getimagesize函数)

getimagesize函数用来检测图片文件大小，同时还用了image_type_to_extension来获取后缀验证。

但诡异的是这里传正常的图片都没法上，搜索了一下发现得自己用十六进制编辑器写一个文件，只包含文件头和恶意语句反而能够上传并成功执行，有点迷，之后会再想想是什么问题。

# Pass-15 (exif_imagetype函数)

exif_imagetype() 读取一个图像的第一个字节并检查其签名。

还是可以直接上马，这次真实的图像文件也可以上传了。